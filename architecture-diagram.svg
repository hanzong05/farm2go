<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 700" width="1400" height="700">
  <!-- Define styles -->
  <defs>
    <style>
      .component-text { font-family: Arial, sans-serif; font-size: 14px; fill: #2c3e50; text-anchor: middle; font-weight: bold; }
      .subtitle-text { font-family: Arial, sans-serif; font-size: 11px; fill: #546e7a; text-anchor: middle; }
      .arrow { stroke: #607d8b; stroke-width: 2.5; fill: none; marker-end: url(#arrowhead); }
      .bidirectional { stroke: #607d8b; stroke-width: 2.5; fill: none; }
      .label-text { font-family: Arial, sans-serif; font-size: 11px; fill: #546e7a; text-anchor: middle; font-weight: 500; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#607d8b" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="700" fill="#ffffff"/>

  <!-- Title -->
  <text x="700" y="30" style="font-family: Arial; font-size: 24px; fill: #2c3e50; text-anchor: middle; font-weight: bold;">Farm2Go Architecture</text>

  <!-- TOP ROW: Mobile Clients -->

  <!-- Farmer App -->
  <g id="farmer-app">
    <rect x="80" y="80" width="120" height="100" rx="10" fill="#eceff1" stroke="#90a4ae" stroke-width="2"/>
    <circle cx="140" cy="120" r="20" fill="#78909c"/>
    <path d="M 130 110 Q 140 100 150 110" stroke="#fff" stroke-width="2" fill="none"/>
    <circle cx="135" cy="115" r="2" fill="#fff"/>
    <circle cx="145" cy="115" r="2" fill="#fff"/>
    <path d="M 133 125 Q 140 130 147 125" stroke="#fff" stroke-width="2" fill="none"/>
    <text x="140" y="155" class="component-text">Farmer App</text>
    <text x="140" y="170" class="subtitle-text">React Native/Expo</text>
  </g>

  <!-- Buyer App -->
  <g id="buyer-app">
    <rect x="280" y="80" width="120" height="100" rx="10" fill="#eceff1" stroke="#90a4ae" stroke-width="2"/>
    <circle cx="340" cy="120" r="20" fill="#78909c"/>
    <circle cx="340" cy="113" r="7" fill="#fff"/>
    <path d="M 325 135 Q 325 125 333 125 Q 340 125 340 125 Q 347 125 355 125 Q 355 135 355 135 Z" fill="#fff"/>
    <text x="340" y="155" class="component-text">Buyer App</text>
    <text x="340" y="170" class="subtitle-text">React Native/Expo</text>
  </g>

  <!-- Admin App -->
  <g id="admin-app">
    <rect x="480" y="80" width="120" height="100" rx="10" fill="#eceff1" stroke="#90a4ae" stroke-width="2"/>
    <circle cx="540" cy="120" r="20" fill="#78909c"/>
    <path d="M 540 110 L 540 130 M 530 120 L 550 120" stroke="#fff" stroke-width="3"/>
    <circle cx="535" cy="115" r="2" fill="#fff"/>
    <circle cx="545" cy="115" r="2" fill="#fff"/>
    <text x="540" y="155" class="component-text">Admin App</text>
    <text x="540" y="170" class="subtitle-text">React Native/Expo</text>
  </g>

  <!-- MIDDLE ROW: API & Services -->

  <!-- Expo Router API -->
  <g id="expo-router">
    <rect x="240" y="270" width="200" height="80" rx="10" fill="#e3f2fd" stroke="#90caf9" stroke-width="2"/>
    <text x="340" y="300" class="component-text">Expo Router</text>
    <text x="340" y="320" class="subtitle-text">File-based Routing</text>
    <text x="340" y="335" class="subtitle-text">Auth Flows</text>
  </g>

  <!-- Supabase Backend -->
  <g id="supabase">
    <rect x="720" y="240" width="240" height="140" rx="10" fill="#e8f5e9" stroke="#81c784" stroke-width="2"/>
    <text x="840" y="270" style="font-family: Arial; font-size: 18px; fill: #2c3e50; text-anchor: middle; font-weight: bold;">Supabase Backend</text>
    <text x="840" y="295" class="subtitle-text">Authentication</text>
    <text x="840" y="312" class="subtitle-text">PostgreSQL Database</text>
    <text x="840" y="329" class="subtitle-text">Real-time Subscriptions</text>
    <text x="840" y="346" class="subtitle-text">Storage (Product Images)</text>
    <text x="840" y="363" class="subtitle-text">Edge Functions</text>
  </g>

  <!-- Services Layer -->
  <g id="services">
    <rect x="1080" y="270" width="220" height="80" rx="10" fill="#fff3e0" stroke="#ffb74d" stroke-width="2"/>
    <text x="1190" y="300" class="component-text">Services Layer</text>
    <text x="1190" y="320" class="subtitle-text">Visual Search (Clarifai)</text>
    <text x="1190" y="335" class="subtitle-text">Push Notifications</text>
  </g>

  <!-- BOTTOM ROW: Data & External Services -->

  <!-- PostgreSQL Tables -->
  <g id="database">
    <rect x="640" y="480" width="140" height="150" rx="10" fill="#f5f5f5" stroke="#9e9e9e" stroke-width="2"/>
    <ellipse cx="710" cy="500" rx="50" ry="12" fill="#bdbdbd"/>
    <text x="710" y="530" class="component-text">Database Tables</text>
    <text x="710" y="550" class="subtitle-text">• profiles</text>
    <text x="710" y="565" class="subtitle-text">• products</text>
    <text x="710" y="580" class="subtitle-text">• orders</text>
    <text x="710" y="595" class="subtitle-text">• transactions</text>
    <text x="710" y="610" class="subtitle-text">• messages</text>
  </g>

  <!-- Storage -->
  <g id="storage">
    <rect x="820" y="480" width="140" height="150" rx="10" fill="#e0f2f1" stroke="#4db6ac" stroke-width="2"/>
    <rect x="850" y="510" width="80" height="60" rx="5" fill="#80cbc4"/>
    <path d="M 870 530 L 870 550 M 880 530 L 880 550 M 890 530 L 890 550 M 900 530 L 900 550 M 910 530 L 910 550" stroke="#00897b" stroke-width="2"/>
    <text x="890" y="595" class="component-text">Supabase Storage</text>
    <text x="890" y="610" class="subtitle-text">Product Images</text>
  </g>

  <!-- Clarifai API -->
  <g id="clarifai">
    <rect x="1000" y="480" width="140" height="150" rx="10" fill="#fef3e2" stroke="#daa520" stroke-width="2"/>
    <circle cx="1070" cy="530" r="30" fill="#f4d79e"/>
    <circle cx="1060" cy="525" r="3" fill="#2c3e50"/>
    <circle cx="1080" cy="525" r="3" fill="#2c3e50"/>
    <path d="M 1055 540 Q 1070 550 1085 540" stroke="#2c3e50" stroke-width="2" fill="none"/>
    <text x="1070" y="595" class="component-text">Clarifai API</text>
    <text x="1070" y="610" class="subtitle-text">Image Recognition</text>
  </g>

  <!-- Expo Push -->
  <g id="expo-push">
    <rect x="1180" y="480" width="140" height="150" rx="10" fill="#ede7f6" stroke="#9575cd" stroke-width="2"/>
    <circle cx="1250" cy="530" r="25" fill="#b39ddb"/>
    <path d="M 1245 520 L 1245 540 M 1255 520 L 1255 540" stroke="#fff" stroke-width="2"/>
    <path d="M 1235 530 L 1245 525 L 1245 535 Z" fill="#fff"/>
    <path d="M 1265 530 L 1255 525 L 1255 535 Z" fill="#fff"/>
    <text x="1250" y="595" class="component-text">Expo Push</text>
    <text x="1250" y="610" class="subtitle-text">Notifications</text>
  </g>

  <!-- CONNECTIONS -->

  <!-- Mobile Apps to Expo Router -->
  <line x1="140" y1="180" x2="290" y2="270" class="arrow"/>
  <line x1="340" y1="180" x2="340" y2="270" class="arrow"/>
  <line x1="540" y1="180" x2="390" y2="270" class="arrow"/>

  <!-- Expo Router to Supabase (bidirectional) -->
  <line x1="440" y1="310" x2="715" y2="310" class="bidirectional"/>
  <polygon points="445,305 435,310 445,315" fill="#607d8b"/>
  <polygon points="710,305 720,310 710,315" fill="#607d8b"/>
  <text x="577" y="300" class="label-text">API Calls / Auth</text>

  <!-- Supabase to Database -->
  <line x1="765" y1="380" x2="710" y2="475" class="arrow"/>
  <text x="750" y="430" class="label-text">RLS Policies</text>

  <!-- Supabase to Storage -->
  <line x1="840" y1="380" x2="890" y2="475" class="arrow"/>
  <text x="880" y="430" class="label-text">File Upload</text>

  <!-- Services to Clarifai -->
  <line x1="1190" y1="350" x2="1070" y2="475" class="arrow"/>
  <text x="1145" y="415" class="label-text">Visual Search</text>

  <!-- Services to Expo Push -->
  <line x1="1230" y1="350" x2="1250" y2="475" class="arrow"/>
  <text x="1255" y="415" class="label-text">Push Tokens</text>

  <!-- Supabase to Services (bidirectional) -->
  <line x1="960" y1="310" x2="1075" y2="310" class="bidirectional"/>
  <polygon points="965,305 955,310 965,315" fill="#607d8b"/>
  <polygon points="1070,305 1080,310 1070,315" fill="#607d8b"/>

  <!-- Real-time connections (dashed) -->
  <line x1="140" y1="200" x2="760" y2="270" stroke="#78909c" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowhead-dashed)"/>
  <line x1="340" y1="200" x2="800" y2="270" stroke="#78909c" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowhead-dashed)"/>
  <text x="450" y="220" class="label-text" fill="#78909c">Real-time Updates</text>

  <marker id="arrowhead-dashed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
    <polygon points="0 0, 10 3, 0 6" fill="#78909c" />
  </marker>

  <!-- Legend -->
  <g id="legend">
    <rect x="50" y="480" width="180" height="120" rx="8" fill="#fafafa" stroke="#bdbdbd" stroke-width="2"/>
    <text x="140" y="505" style="font-family: Arial; font-size: 13px; fill: #2c3e50; text-anchor: middle; font-weight: bold;">Legend</text>

    <line x1="70" y1="520" x2="110" y2="520" class="arrow"/>
    <text x="125" y="525" style="font-family: Arial; font-size: 11px; fill: #546e7a;">API Call</text>

    <line x1="70" y1="540" x2="110" y2="540" class="bidirectional"/>
    <polygon points="75,535 65,540 75,545" fill="#607d8b"/>
    <polygon points="105,535 115,540 105,545" fill="#607d8b"/>
    <text x="125" y="545" style="font-family: Arial; font-size: 11px; fill: #546e7a;">Bidirectional</text>

    <line x1="70" y1="560" x2="110" y2="560" stroke="#78909c" stroke-width="2" stroke-dasharray="5,5" fill="none"/>
    <text x="125" y="565" style="font-family: Arial; font-size: 11px; fill: #546e7a;">Real-time</text>
  </g>

  <!-- User Flow Indicators -->
  <g id="flow-indicators">
    <circle cx="140" cy="60" r="8" fill="#78909c"/>
    <text x="160" y="65" style="font-family: Arial; font-size: 10px; fill: #546e7a;">Farmer Flow</text>

    <circle cx="340" cy="60" r="8" fill="#78909c"/>
    <text x="360" y="65" style="font-family: Arial; font-size: 10px; fill: #546e7a;">Buyer Flow</text>

    <circle cx="540" cy="60" r="8" fill="#78909c"/>
    <text x="560" y="65" style="font-family: Arial; font-size: 10px; fill: #546e7a;">Admin Flow</text>
  </g>

</svg>